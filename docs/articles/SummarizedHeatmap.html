<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Summarized Heatmap Vignette • blaseRtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarized Heatmap Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blaseRtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9184</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Ape.html">Reading, Editing and Writing DNA Sequences with Ape</a></li>
    <li><a class="dropdown-item" href="../articles/blind_images.html">Blinding Images</a></li>
    <li><a class="dropdown-item" href="../articles/scRNAseq.html">scRNA-seq Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/SummarizedHeatmap.html">Summarized Heatmap Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/trace.html">Trace:  Representing Track-like Data in R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/blaserlab/blaseRtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Summarized Heatmap Vignette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/blaserlab/blaseRtools/blob/HEAD/vignettes/SummarizedHeatmap.Rmd" class="external-link"><code>vignettes/SummarizedHeatmap.Rmd</code></a></small>
      <div class="d-none name"><code>SummarizedHeatmap.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Heatmaps are useful but can be difficult to customize appropriately.
A critical issue is verifying the alignment between the main body of the
heatmap and any marginal annotations and dendrograms.</p>
<p>The SummarizedExperiment class is designed to hold matrices together
with optional descriptive data for column and rownames. Validation
methods ensure these are always kept in order. The SummarizedHeatmap
class is a derivative of this class with similar validation methods.</p>
<p>The approach is to start with a matrix, typically with samples as
columns and genes or other features as rows. Values represent gene
counts, cell counts or some other numeric value. Then create a
SummarizedHeatmap object. Then add the desired colData and rowData to
supply data for annotations. Clustering occurs with the construction of
the SummarizedHeatmap object. A set of plotting functions is provided
for the main heatmap body, column and row annotations, dendrograms, and
highlights. The final heatmap is composed using <em>patchwork</em>.</p>
</div>
<div class="section level2">
<h2 id="constructing-a-summarizedheatmap">Constructing a SummarizedHeatmap<a class="anchor" aria-label="anchor" href="#constructing-a-summarizedheatmap"></a>
</h2>
<p>First obtain a matrix of values. The columns and rows should be
named.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span></code></pre></div>
<p>Next use the constructor function to generate the heatmap.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/blaserlab/blaseRtools" class="external-link">blaseRtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">my_heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SummarizedHeatmap.html">SummarizedHeatmap</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="va">my_heatmap</span></span>
<span><span class="co">#&gt; class: SummarizedHeatmap </span></span>
<span><span class="co">#&gt; dim: 20 5 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): matrix</span></span>
<span><span class="co">#&gt; rownames(20): f g ... x y</span></span>
<span><span class="co">#&gt; rowData names(0):</span></span>
<span><span class="co">#&gt; colnames(5): a b c d e</span></span>
<span><span class="co">#&gt; colData names(0):</span></span></code></pre></div>
<p>Add column and row metadata. Here we show a trivial example. Usually
you will want to extract this information from the same object that
generated the matrix. For example, a cell_data_set object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span><span class="op">$</span><span class="va">sample_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vowel"</span>, <span class="st">"consonant"</span>, <span class="st">"consonant"</span>, <span class="st">"consonant"</span>, <span class="st">"vowel"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">isVowel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">char</span><span class="op">)</span> <span class="va">char</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'e'</span>, <span class="st">'i'</span>, <span class="st">'o'</span>, <span class="st">'u'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span><span class="op">$</span><span class="va">feature_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">isVowel</span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span>, <span class="st">"vowel"</span>, <span class="st">"consonant"</span><span class="op">)</span></span></code></pre></div>
<p>Use the “getter” functions to extract the metadata and check to be
sure it was added correctly.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 5 rows and 1 column</span></span>
<span><span class="co">#&gt;   sample_type</span></span>
<span><span class="co">#&gt;   &lt;character&gt;</span></span>
<span><span class="co">#&gt; a       vowel</span></span>
<span><span class="co">#&gt; b   consonant</span></span>
<span><span class="co">#&gt; c   consonant</span></span>
<span><span class="co">#&gt; d   consonant</span></span>
<span><span class="co">#&gt; e       vowel</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 20 rows and 1 column</span></span>
<span><span class="co">#&gt;     feature_type</span></span>
<span><span class="co">#&gt;      &lt;character&gt;</span></span>
<span><span class="co">#&gt; f      consonant</span></span>
<span><span class="co">#&gt; g      consonant</span></span>
<span><span class="co">#&gt; h      consonant</span></span>
<span><span class="co">#&gt; i          vowel</span></span>
<span><span class="co">#&gt; j      consonant</span></span>
<span><span class="co">#&gt; ...          ...</span></span>
<span><span class="co">#&gt; u          vowel</span></span>
<span><span class="co">#&gt; v      consonant</span></span>
<span><span class="co">#&gt; w      consonant</span></span>
<span><span class="co">#&gt; x      consonant</span></span>
<span><span class="co">#&gt; y      consonant</span></span></code></pre></div>
<p>For most cases, that is all you need to do. Variations are shown at
the end.</p>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>It is important to familiarize yourself with the <em>patchwork
package</em> for composing plots. It is very useful for putting together
complex figures and for compositing many panels into a single page for a
publication or grant.</p>
<p>The approach here is to plot each element individually and then
compose the elements into the final figure panel.</p>
<p><strong>Critical:</strong> Although the SummarizedHeatmap object has
validation checks, the plotting functions do not. This means that you
can accidentally put the wrong dendrogram on a heatmap if you don’t
check your code. Always follow good practice when coding these objects.
Best practice is to wrap your plotting functions inside another function
to control the scope of your variables. This looks more complicated to
begin with but will become clear by the end.</p>
<div class="section level3">
<h3 id="plot-the-main-heatmap-body">Plot the main heatmap body<a class="anchor" aria-label="anchor" href="#plot-the-main-heatmap-body"></a>
</h3>
<p>A simple example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p1</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Change the color palette:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span>, high <span class="op">=</span> <span class="st">"purple"</span>, mid <span class="op">=</span> <span class="st">"black"</span>, low <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span></span>
<span>  <span class="va">p1</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>All plotting functions return ggplots, so if an internal parameter
you want to change is not available, you can do so by adding layers:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Expr."</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">p1</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="adding-dendrograms">Adding dendrograms<a class="anchor" aria-label="anchor" href="#adding-dendrograms"></a>
</h3>
<p>You make the column and row dendrograms using their own
functions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<p>These are not so useful on their own, so we can incoporate them into
the heatmap like this. Note how we are using the patchwork to make the
layout</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  #2#</span></span>
<span><span class="st">  314</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>, </span>
<span>                             guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>                             widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                             heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Currently the only aesthetic you can change for the dendrograms is
linewidth:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span>, linewidth <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  #2#</span></span>
<span><span class="st">  314</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>, </span>
<span>                             guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>                             widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                             heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="row-and-column-annotations">Row and Column Annotations<a class="anchor" aria-label="anchor" href="#row-and-column-annotations"></a>
</h3>
<p>Adding column annotations:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colData.html">bb_plot_heatmap_colData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  #2#</span></span>
<span><span class="st">  #54</span></span>
<span><span class="st">  314</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="va">p5</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-12-1.png" width="700">
Adding row annotations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ##2#</span></span>
<span><span class="st">  3514</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="va">p5</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>That looks weird because <em>patchwork</em> is leaving space for the
“feature_type” text. You can tell it to override this like so:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ##2#</span></span>
<span><span class="st">  3514</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p5</span>, side <span class="op">=</span> <span class="st">"t"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>You can also move the annotation text to the other side:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ##2#</span></span>
<span><span class="st">  3514</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="va">p5</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>You can add row and column annotations together:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colData.html">bb_plot_heatmap_colData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ##2#</span></span>
<span><span class="st">  ##54</span></span>
<span><span class="st">  3614</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="va">p5</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p6</span>, side <span class="op">=</span> <span class="st">"t"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="heatmap-highlights">Heatmap Highlights<a class="anchor" aria-label="anchor" href="#heatmap-highlights"></a>
</h3>
<p>Sometimes you have too many rows or columns on your plot and you want
to cherry pick a few to show your reader.</p>
<ol style="list-style-type: decimal">
<li>Remove the axis text using ggplot layers</li>
<li>Add a new plot with the highlights to the patchwork:</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colData.html">bb_plot_heatmap_colData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowHighlight.html">bb_plot_heatmap_rowHighlight</a></span><span class="op">(</span><span class="va">hm</span>, highlights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"m"</span>, <span class="st">"n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  ##2##</span></span>
<span><span class="st">  ##5#4</span></span>
<span><span class="st">  36174</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> </span>
<span>    <span class="va">p2</span> <span class="op">+</span> </span>
<span>    <span class="va">p3</span> <span class="op">+</span> </span>
<span>    <span class="va">p4</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p5</span>, side <span class="op">=</span> <span class="st">"r"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p6</span>, side <span class="op">=</span> <span class="st">"t"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="va">p7</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="customization">Customization<a class="anchor" aria-label="anchor" href="#customization"></a>
</h2>
<p>Here is another example with more customizations.</p>
<ol style="list-style-type: decimal">
<li>Custom color palettes for annotations</li>
<li>Selecting which annotations to show</li>
<li>Renaming the labels for annotations</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  the_letters <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  sample_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vowel"</span>, <span class="st">"consonant"</span>, <span class="st">"consonant"</span>, <span class="st">"consonant"</span>, <span class="st">"vowel"</span><span class="op">)</span>,</span>
<span>  sample_type2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vowel2"</span>, <span class="st">"consonant2"</span>, <span class="st">"consonant2"</span>, <span class="st">"consonant2"</span>, <span class="st">"vowel2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">isVowel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">char</span><span class="op">)</span></span>
<span>  <span class="va">char</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'e'</span>, <span class="st">'i'</span>, <span class="st">'o'</span>, <span class="st">'u'</span><span class="op">)</span></span>
<span><span class="va">feature_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  the_letters <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span>,</span>
<span>  feature_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">isVowel</span><span class="op">(</span><span class="va">the_letters</span><span class="op">)</span>, <span class="st">"vowel"</span>, <span class="st">"consonant"</span><span class="op">)</span>,</span>
<span>  feature_type2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">feature_type</span>, <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">the_letters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">feature_data</span><span class="op">$</span><span class="va">the_letters</span></span>
<span></span>
<span><span class="va">my_custom_heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SummarizedHeatmap.html">SummarizedHeatmap</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">my_custom_heatmap</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">sample_data</span>, row.names <span class="op">=</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">the_letters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">my_custom_heatmap</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">feature_data</span>, row.names <span class="op">=</span> <span class="va">feature_data</span><span class="op">$</span><span class="va">the_letters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_custom_heatmap_plotting_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span>, side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colData.html">bb_plot_heatmap_colData</a></span><span class="op">(</span></span>
<span>    <span class="va">hm</span>,</span>
<span>    vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sample Type"</span> <span class="op">=</span> <span class="st">"sample_type"</span>, </span>
<span>             <span class="st">"Sample Type 2"</span> <span class="op">=</span> <span class="st">"sample_type2"</span><span class="op">)</span>,</span>
<span>    manual_pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"consonant"</span> <span class="op">=</span> <span class="st">"ivory"</span>,</span>
<span>      <span class="st">"vowel"</span> <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>      <span class="st">"consonant2"</span> <span class="op">=</span> <span class="st">"cornsilk"</span>,</span>
<span>      <span class="st">"vowel2"</span> <span class="op">=</span> <span class="st">"pink3"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span></span>
<span>    <span class="va">hm</span>,</span>
<span>    vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Feature Type"</span> <span class="op">=</span> <span class="st">"feature_type"</span>,</span>
<span>             <span class="st">"Feature Type2"</span> <span class="op">=</span> <span class="st">"feature_type2"</span><span class="op">)</span>,</span>
<span>    manual_pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"consonant"</span> <span class="op">=</span> <span class="st">"ivory3"</span>,</span>
<span>      <span class="st">"vowel"</span> <span class="op">=</span> <span class="st">"pink4"</span>,</span>
<span>      <span class="st">"consonant2"</span> <span class="op">=</span> <span class="st">"bisque1"</span>,</span>
<span>      <span class="st">"vowel2"</span> <span class="op">=</span> <span class="st">"lightpink3"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span>, tile_color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">##1#</span></span>
<span><span class="st">##36</span></span>
<span><span class="st">2456</span></span>
<span><span class="st"></span></span>
<span><span class="st">"</span></span>
<span><span class="va">p1</span> <span class="op">+</span> </span>
<span>  <span class="va">p2</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p3</span>, side <span class="op">=</span> <span class="st">"r"</span>,  type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p4</span>, side <span class="op">=</span> <span class="st">"t"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">p5</span> <span class="op">+</span> </span>
<span>  <span class="va">p6</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">design</span>,</span>
<span>  widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  guides <span class="op">=</span> <span class="st">"collect"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_custom_heatmap_plotting_function</span><span class="op">(</span><span class="va">my_custom_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="other-variations">Other variations<a class="anchor" aria-label="anchor" href="#other-variations"></a>
</h2>
<div class="section level3">
<h3 id="transposing-the-plot">Transposing the plot<a class="anchor" aria-label="anchor" href="#transposing-the-plot"></a>
</h3>
<p>By convention we normally put samples as columns and features as
rows. This is not strictly enforced by the object. So it is possible to
transpose the matrix and swap the colData/rowData when making the
SummarizedHeatmap object. Another option is to flip the heatmap and all
of the annotations. You do this by flipping the main heatmap body and
setting the sides of the annotations and dendrograms the way you like.
(You can also use this to put the annotations on any side, whether or
not you flip the main heatmap).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_flipped_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span>, flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colDendro.html">bb_plot_heatmap_colDendro</a></span><span class="op">(</span><span class="va">hm</span>, side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colData.html">bb_plot_heatmap_colData</a></span><span class="op">(</span><span class="va">hm</span>, side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span>, side <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span>, side <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span>  <span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p7</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/bb_plot_heatmap_colHighlight.html">bb_plot_heatmap_colHighlight</a></span><span class="op">(</span><span class="va">hm</span>,</span>
<span>                                 highlights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>                                 side <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span>  <span class="va">p8</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/bb_plot_heatmap_rowHighlight.html">bb_plot_heatmap_rowHighlight</a></span><span class="op">(</span><span class="va">hm</span>,</span>
<span>                                 highlights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"s"</span>, <span class="st">"v"</span><span class="op">)</span>,</span>
<span>                                 side <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">##4#6</span></span>
<span><span class="st">##5#6</span></span>
<span><span class="st">23176</span></span>
<span><span class="st">##8##</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> </span>
<span>  <span class="va">p2</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p3</span>, side <span class="op">=</span> <span class="st">"t"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">p4</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p5</span>, side <span class="op">=</span> <span class="st">"r"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">p6</span> <span class="op">+</span> </span>
<span>  <span class="va">p7</span> <span class="op">+</span> </span>
<span>  <span class="va">p8</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">design</span>, </span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_flipped_heatmap_plot_function</span><span class="op">(</span><span class="va">my_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="manual-ordering">Manual ordering<a class="anchor" aria-label="anchor" href="#manual-ordering"></a>
</h3>
<p>Usually clustering rows and columns produces a more interpretable
figure, but on rare occasions you may wish to manually establish the
order of columns or rows.</p>
<p>To do this, provide a character vector corresponding to this order to
the constructor function. Note that you cannot manually specify
row/column order and retain a dendrogram for that dimension.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span>
<span></span>
<span><span class="va">my_ordered_heatmap</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/SummarizedHeatmap.html">SummarizedHeatmap</a></span><span class="op">(</span><span class="va">mat</span>, colOrder <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">my_ordered_heatmap</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">sample_data</span>, row.names <span class="op">=</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">the_letters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">my_ordered_heatmap</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="va">feature_data</span>, row.names <span class="op">=</span> <span class="va">feature_data</span><span class="op">$</span><span class="va">the_letters</span><span class="op">)</span></span>
<span><span class="co"># set col order</span></span>
<span><span class="va">my_ordered_heatmap_plot_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">hm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_main.html">bb_plot_heatmap_main</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_spacer.html" class="external-link">plot_spacer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_colData.html">bb_plot_heatmap_colData</a></span><span class="op">(</span><span class="va">hm</span>, vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample_type"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowDendro.html">bb_plot_heatmap_rowDendro</a></span><span class="op">(</span><span class="va">hm</span><span class="op">)</span></span>
<span>  <span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plot_heatmap_rowData.html">bb_plot_heatmap_rowData</a></span><span class="op">(</span><span class="va">hm</span>, vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature_type"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/guide_area.html" class="external-link">guide_area</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">##2#</span></span>
<span><span class="st">##36</span></span>
<span><span class="st">4516</span></span>
<span><span class="st">"</span></span>
<span><span class="va">p1</span> <span class="op">+</span> </span>
<span>  <span class="va">p2</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p3</span>, side <span class="op">=</span> <span class="st">"r"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">p4</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/free.html" class="external-link">free</a></span><span class="op">(</span><span class="va">p5</span>, side <span class="op">=</span> <span class="st">"t"</span>, type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">p6</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>, </span>
<span>              guides <span class="op">=</span> <span class="st">"collect"</span>, </span>
<span>              heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>              widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_ordered_heatmap_plot_function</span><span class="op">(</span><span class="va">my_ordered_heatmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="SummarizedHeatmap_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brad Blaser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
