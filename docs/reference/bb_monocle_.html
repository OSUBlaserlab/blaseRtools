<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Annotate Single cell Data Using Monocle3 — bb_monocle_ • blaseRtools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Annotate Single cell Data Using Monocle3 — bb_monocle_"><meta name="description" content='This function wraps the monocle3 method for data projection and label transfer into a function.  This function takes in reference and query cds objects plus a character vector of label column names and returns the query CDS with the new labels.
bb_monocle_anno and bb_monocle_project use similar inputs and methods and both return cds objects, but the cds objects are different.  Both wrap around the monocle3 mehtod for data projection and label transfer.
bb_monocle_anno takes in reference and query cds objects plus a character vector of label column names to transfer.  It returns the query CDS with new cell metadata contining one or more columns with the labels corresponding to the nearest neighbor in the reference data.  A suffix is appended to the new column name in the result. By default this is "_ref" but it can be changed using the suffix parameter.
bb_monocle_project also takes in reference and query cds objects and character vector of label column names.  In this case, a combined cds object is returned carrying the query and reference data projected int the reference data space.  New column names are added indicating the reference and query data.  The query cells are given the label of their nearest neighbor in the reference.  These label column(s) are prepended with "merged_".
Importantly, for both of these to work, the reference and query genes must have a shared namespace.'><meta property="og:description" content='This function wraps the monocle3 method for data projection and label transfer into a function.  This function takes in reference and query cds objects plus a character vector of label column names and returns the query CDS with the new labels.
bb_monocle_anno and bb_monocle_project use similar inputs and methods and both return cds objects, but the cds objects are different.  Both wrap around the monocle3 mehtod for data projection and label transfer.
bb_monocle_anno takes in reference and query cds objects plus a character vector of label column names to transfer.  It returns the query CDS with new cell metadata contining one or more columns with the labels corresponding to the nearest neighbor in the reference data.  A suffix is appended to the new column name in the result. By default this is "_ref" but it can be changed using the suffix parameter.
bb_monocle_project also takes in reference and query cds objects and character vector of label column names.  In this case, a combined cds object is returned carrying the query and reference data projected int the reference data space.  New column names are added indicating the reference and query data.  The query cells are given the label of their nearest neighbor in the reference.  These label column(s) are prepended with "merged_".
Importantly, for both of these to work, the reference and query genes must have a shared namespace.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blaseRtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9184</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Ape.html">Reading, Editing and Writing DNA Sequences with Ape</a></li>
    <li><a class="dropdown-item" href="../articles/blind_images.html">Blinding Images</a></li>
    <li><a class="dropdown-item" href="../articles/scRNAseq.html">scRNA-seq Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/SummarizedHeatmap.html">Summarized Heatmap Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/trace.html">Trace:  Representing Track-like Data in R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/blaserlab/blaseRtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Annotate Single cell Data Using Monocle3</h1>
      <small class="dont-index">Source: <a href="https://github.com/blaserlab/blaseRtools/blob/HEAD/R/bb_monocle_anno_project.R" class="external-link"><code>R/bb_monocle_anno_project.R</code></a></small>
      <div class="d-none name"><code>bb_monocle_.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function wraps the monocle3 method for data projection and label transfer into a function.  This function takes in reference and query cds objects plus a character vector of label column names and returns the query CDS with the new labels.</p>
<p>bb_monocle_anno and bb_monocle_project use similar inputs and methods and both return cds objects, but the cds objects are different.  Both wrap around the monocle3 mehtod for data projection and label transfer.</p>
<p>bb_monocle_anno takes in reference and query cds objects plus a character vector of label column names to transfer.  It returns the query CDS with new cell metadata contining one or more columns with the labels corresponding to the nearest neighbor in the reference data.  A suffix is appended to the new column name in the result. By default this is "_ref" but it can be changed using the suffix parameter.</p>
<p>bb_monocle_project also takes in reference and query cds objects and character vector of label column names.  In this case, a combined cds object is returned carrying the query and reference data projected int the reference data space.  New column names are added indicating the reference and query data.  The query cells are given the label of their nearest neighbor in the reference.  These label column(s) are prepended with "merged_".</p>
<p>Importantly, for both of these to work, the reference and query genes must have a shared namespace.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bb_monocle_</span><span class="op">(</span><span class="va">cds_qry</span>, <span class="va">cds_ref</span>, <span class="va">labels</span>, <span class="va">suffix</span>, <span class="va">use_aligned</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bb_monocle_anno</span><span class="op">(</span><span class="va">cds_qry</span>, <span class="va">cds_ref</span>, <span class="va">labels</span>, suffix <span class="op">=</span> <span class="st">"_ref"</span>, use_aligned <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bb_monocle_project</span><span class="op">(</span></span>
<span>  <span class="va">cds_qry</span>,</span>
<span>  <span class="va">cds_ref</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  suffix <span class="op">=</span> <span class="st">"_ref"</span>,</span>
<span>  use_aligned <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cds-qry">cds_qry<a class="anchor" aria-label="anchor" href="#arg-cds-qry"></a></dt>
<dd><p>A query cell data set.</p></dd>


<dt id="arg-cds-ref">cds_ref<a class="anchor" aria-label="anchor" href="#arg-cds-ref"></a></dt>
<dd><p>A reference cell data set.</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>A character vector of cell metadata column names to transfer.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>A character string of length 1 to append to all of the tranferred column names.  There is no checking for name conflicts, so use this sensibly to prevent overwriting preexisting columns.  Default = "_ref".</p></dd>


<dt id="arg-use-aligned">use_aligned<a class="anchor" aria-label="anchor" href="#arg-use-aligned"></a></dt>
<dd><p>Whether to use aligned PCA coordinates from cds_ref, if they are available.  Default = TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A cell data set</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>see https://cole-trapnell-lab.github.io/monocle3/docs/projection/</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></code>, <code><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert</a></code>
<code>sets</code>
<code><a href="https://rdrr.io/pkg/monocle3/man/estimate_size_factors.html" class="external-link">estimate_size_factors</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/preprocess_cds.html" class="external-link">preprocess_cds</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/reduce_dimension.html" class="external-link">reduce_dimension</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/save_transform_models.html" class="external-link">save_transform_models</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/load_transform_models.html" class="external-link">load_transform_models</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/preprocess_transform.html" class="external-link">preprocess_transform</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/reduce_dimension_transform.html" class="external-link">reduce_dimension_transform</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/transfer_cell_labels.html" class="external-link">transfer_cell_labels</a></code>, <code><a href="https://rdrr.io/pkg/monocle3/man/fix_missing_cell_labels.html" class="external-link">fix_missing_cell_labels</a></code>
<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDims</a></code>
<code><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></code>
<code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></code>, <code><a href="https://purrr.tidyverse.org/reference/reduce.html" class="external-link">reduce</a></code>
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment-class</a></code>
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">mutate-joins</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="co">#EXAMPLE1</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brad Blaser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

